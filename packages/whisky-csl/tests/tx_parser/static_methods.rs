#[cfg(test)]
mod tests {
    use whisky_csl::CSLParser;

    #[test]
    fn test_check_required_signers() {
        let mut parser = CSLParser::new_with_body("84a80082825820604943e070ffbf81cc09bb2942029f5f5361108a3c0b96a7309e6aa70370ad9800825820604943e070ffbf81cc09bb2942029f5f5361108a3c0b96a7309e6aa70370ad98010d81825820604943e070ffbf81cc09bb2942029f5f5361108a3c0b96a7309e6aa70370ad9801128182582004b9070a30bd63abaaf59a3c48a1575c4127bb0edb00ecd5141fd18a85c721aa000181a200581d601fd5bab167338971d92b4d8f0bdf57d889903e6e934e7ea38c7dadf1011b00000002529898c810a200581d601fd5bab167338971d92b4d8f0bdf57d889903e6e934e7ea38c7dadf1011b0000000252882db4111a000412f1021a0002b74b0b5820775d0cf3c95993f6210e4410e92f72ebc3942ce9c1433694749aa239e5d13387a200818258201557f444f3ae6e61dfed593ae15ec8dbd57b8138972bf16fde5b4c559f41549b5840729f1f14ef05b7cf9b0d7583e6777674f80ae64a35bbd6820cc3c82ddf0412ca1d751b7d886eece3c6e219e1c5cc9ef3d387a8d2078f47125d54b474fbdfbd0105818400000182190b111a000b5e35f5f6").unwrap();
        let result = parser.check_all_required_signers().unwrap();
        assert!(result);
    }

    #[test]
    fn test_check_required_signers_2() {
        let mut parser = CSLParser::new_with_body("84ab00d9010282825820108e614afc0f7d5a644043d24eca934ecf4e01ec1dac9cc1a0d4213f36611b1900825820a3202147bd7113dbf322635c286b4647358c00ea40053210c205b3c948147487000182a300581d70b11f2ab89a47ab78afb9dc80f75da5c29ef63cbdbdd24d8510e6a34d01821b000000012a05f200a2581cc69b981db7a65e339a6d783755f85a2e03afa1cece9714c55fe4c913a1445553444d1b000000012a05f200581cd9ada3364341deacbee0afd8221539f9f5c0ef5d01f2ed2c3a28ce27a14001028201d818589bd8799fd8799fd8799f50cb54c8aa0aba4852ae9821d40e4fdc11d8799f581cfdeb4bf0e8c077114a4553f1e05395e9fb7114db177f02f7b65c8de4ffd8799f581cb21f857716821354725bc2bd255dc2e5d5fdfa202556039b76c080a5ffffffa240a1401b000000012a05f200581cc69b981db7a65e339a6d783755f85a2e03afa1cece9714c55fe4c913a1445553444d1b000000012a05f200ff82583900fdeb4bf0e8c077114a4553f1e05395e9fb7114db177f02f7b65c8de44e660f79ce4221d52a2dc249da925112b3ea46bcaba9ce48174fa358821b00000073406635d6a1581cc69b981db7a65e339a6d783755f85a2e03afa1cece9714c55fe4c913a1445553444d1b000000e7aa9f1e00021a0004e4aa075820bdaa99eb158414dea0a91d6c727e2268574b23efe6e08ab3b841abe8059a030c09a1581cd9ada3364341deacbee0afd8221539f9f5c0ef5d01f2ed2c3a28ce27a140010b58207e4f2bed7a6845e9cd532a7a82cf18406159293666e9bd0427dd829657b397150dd9010281825820822fec214424c3651fd279d1012825dc3f0610605e168fa3854cc23258eadf38020ed9010281581cfa5136e9e9ecbc9071da73eeb6c9a4ff73cbf436105cf8380d1c525c1082583900fdeb4bf0e8c077114a4553f1e05395e9fb7114db177f02f7b65c8de44e660f79ce4221d52a2dc249da925112b3ea46bcaba9ce48174fa3581b000000012e387484111a001e848012d901028282582052a441f96c7cbdf1103195cb2fea10e8a3490fbcdaeb4c8e76eb2e9110714d6600825820b409530f3725fb1b04bb586733e346f75dca886627a2bc22ff417a14b52af8b500a105a182010082d87980821a000863831a0a149327f5d90103a0").unwrap();
        let result = parser.check_all_required_signers().unwrap();
        assert!(!result);
    }
}
